<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wdb3a.CookerMapper">
	<select id="foodStock" resultType="FoodMInven">
		select b.foodMName, c.foodMAmount, a.inAmount, a.uint
		from foodMInven a join sideDInfo c join foodMaterial b
		where b.foodMCode = c.foodMCode
		<include refid="search"></include>
	</select>
	<sql id = "search">
	  	<if test = "searchType != null">
	  		<if test="searchType == 't'.toString()">
	  			and b.foodMName like CONCAT('%',#{keyword},'%')
	  		</if>
	  		<if test="searchType == 'c'.toString()">
	  			and c.foodMAmount like CONCAT('%',#{keyword},'%')
	  		</if>
	  	</if>
  </sql>
  <select id = "cookList" resultType = "Cook">
	select b.sideDName, sum(a.dietAmount) as dietAmount, a.orderItemCode, d.orderItemName
   from orderlist a join sidedish b join dietinfo c join orderitem d
   where a.dietCode = c.dietCode
   and c.sideDCode = b.sideDCode
   and a.orderItemCode = d.orderItemCode
   and a.orderItemCode = 3
   group by b.sideDName
  </select>
  
   <select id = "finishcook" resultType = "Cook">
	select b.sideDName, sum(a.dietAmount) as dietAmount, a.orderItemCode, d.orderItemName
   from orderlist a join sidedish b join dietinfo c join orderitem d
   where a.dietCode = c.dietCode
   and c.sideDCode = b.sideDCode
   and a.orderItemCode = d.orderItemCode
   and a.orderItemCode = 5
   group by b.sideDName
  </select>
 
  <select id ="readycook" resultType = "Cook">
  select a.orderCode, b.sideDName, sum(a.dietAmount) as dietAmount, a.orderItemCode
	from orderlist a join sidedish b join dietinfo c
	where a.dietCode = c.dietCode
	and c.sideDCode = b.sideDCode
	and a.orderItemCode = 3 
	group by b.sideDName
  </select>
  <update id = "transportNum2">
  		update orderlist set orderItemCode = 5
  		where orderCode = #{orderCode}
  	</update>
  
</mapper>